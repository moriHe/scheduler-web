{"mappings":"A,S,E,C,C,C,C,C,C,C,E,O,c,C,E,E,C,I,E,I,E,W,C,E,a,C,C,E,C,I,E,W,E,C,E,E,C,E,E,E,iB,A,O,I,A,C,E,S,C,E,G,K,E,O,C,C,E,C,O,C,G,K,E,C,I,E,C,C,E,A,Q,C,C,E,C,I,E,C,G,E,Q,C,C,E,O,C,C,E,C,E,E,I,C,E,O,C,E,E,O,E,E,O,A,C,I,E,A,M,uB,E,I,O,E,I,C,mB,C,C,E,Q,C,S,C,C,C,E,C,C,E,C,C,E,E,iB,C,G,I,E,E,Q,C,E,Q,S,C,C,C,E,E,E,O,C,a,I,G,I,E,E,S,E,E,S,E,E,S,E,E,S,E,E,SCYA,IAAI,EAAY,EAAE,CACd,EAAiB,EAAE,CACnB,EAAmB,EAAE,CACnB,EAAkB,CACpB,GAAI,SACJ,GAAI,UACJ,GAAI,YACJ,GAAI,WACJ,GAAI,SACJ,GAAI,WACJ,GAAI,QACR,EACI,EAAW,EAAE,CACb,EAAe,EAAE,CACjB,EAAW,EAAE,CACb,EAAW,KAGR,SAAS,EAAW,CAAO,EAC9B,IAAM,EAAY,SAAS,cAAc,CAAC,kBACpC,EAAgB,SAAS,cAAc,CAAC,kBAE9C,EAAU,gBAAgB,CAAC,QAAS,KAChC,EAAc,SAAS,CAAC,MAAM,CAAC,SACnC,GAEA,IAAM,EAAY,aAAa,OAAO,CAAC,AAAA,CAAA,EAAA,EAAA,aAAY,AAAZ,IACnC,CAAA,GACA,CAAA,EAAY,KAAK,KAAK,CAAC,EAD3B,EAGA,AAAA,CAAA,EAAA,EAAA,qBAAoB,AAApB,IAgDA,EAAiB,AA/CD,EA+CO,GAAG,CAAC,AAAC,GAAU,CAAA,CAClC,KAAM,EACN,cAAe,EAAE,AACrB,CAAA,GAjDA,IAEA,SAAS,cAAc,CAAC,eAAe,gBAAgB,CAAC,QAAS,KAC7D,OAAO,QAAQ,CAAC,IAAI,CAAG,CAC3B,GAEA,SAAS,cAAc,CAAC,SAAS,gBAAgB,CAAC,SAAU,IAAM,KAClE,SAAS,cAAc,CAAC,QAAQ,gBAAgB,CAAC,SAAU,IAAM,KAEjE,SAAS,cAAc,CAAC,gBAAgB,gBAAgB,CAAC,QAAS,KAC9D,EAAsB,EAAe,MAAM,CAAC,AAAA,GAAQ,EAAK,IAAI,GAAK,SAAS,c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","sources":["<anon>","src/create/create.js","src/create/generateShiftplanPdf.js","src/create/assignUsersCalendar.js"],"sourcesContent":["\nfunction $parcel$export(e, n, v, s) {\n  Object.defineProperty(e, n, {get: v, set: s, enumerable: true, configurable: true});\n}\n\n      var $parcel$global = globalThis;\n    \nvar $parcel$modules = {};\nvar $parcel$inits = {};\n\nvar parcelRequire = $parcel$global[\"parcelRequire5416\"];\n\nif (parcelRequire == null) {\n  parcelRequire = function(id) {\n    if (id in $parcel$modules) {\n      return $parcel$modules[id].exports;\n    }\n    if (id in $parcel$inits) {\n      var init = $parcel$inits[id];\n      delete $parcel$inits[id];\n      var module = {id: id, exports: {}};\n      $parcel$modules[id] = module;\n      init.call(module.exports, module, module.exports);\n      return module.exports;\n    }\n    var err = new Error(\"Cannot find module '\" + id + \"'\");\n    err.code = 'MODULE_NOT_FOUND';\n    throw err;\n  };\n\n  parcelRequire.register = function register(id, init) {\n    $parcel$inits[id] = init;\n  };\n\n  $parcel$global[\"parcelRequire5416\"] = parcelRequire;\n}\n\nvar parcelRegister = parcelRequire.register;\nparcelRegister(\"jV0jS\", function(module, exports) {\n\n$parcel$export(module.exports, \"initialize\", () => $e80396a3d35d2658$export$2a47f398eeff8b01);\n\nvar $iOioM = parcelRequire(\"iOioM\");\n\nvar $iVdgJ = parcelRequire(\"iVdgJ\");\n\nvar $kaKyP = parcelRequire(\"kaKyP\");\n\nvar $dVfXR = parcelRequire(\"dVfXR\");\n\nvar $VIWgv = parcelRequire(\"VIWgv\");\nlet $e80396a3d35d2658$var$usersData = []; // Temporäre Speicherung der Nutzerdaten\nlet $e80396a3d35d2658$var$formattedUsers = []; // Formatierte Nutzerdaten\nlet $e80396a3d35d2658$var$selectedWeekdays = [];\nconst $e80396a3d35d2658$var$WEEKDAY_MAPPING = {\n    Mo: \"Monday\",\n    Di: \"Tuesday\",\n    Mi: \"Wednesday\",\n    Do: \"Thursday\",\n    Fr: \"Friday\",\n    Sa: \"Saturday\",\n    So: \"Sunday\"\n};\nlet $e80396a3d35d2658$var$holidays = [];\nlet $e80396a3d35d2658$var$kitaOpenNoEd = [];\nlet $e80396a3d35d2658$var$teamdays = [];\nlet $e80396a3d35d2658$var$calendar = null;\nfunction $e80396a3d35d2658$export$2a47f398eeff8b01(backurl) {\n    const toggleBtn = document.getElementById('toggle-summary');\n    const parentSummary = document.getElementById('parent-summary');\n    toggleBtn.addEventListener('click', ()=>{\n        parentSummary.classList.toggle('hidden');\n    });\n    const jsonUsers = localStorage.getItem((0, $iOioM.getStorageKey)());\n    if (jsonUsers) $e80396a3d35d2658$var$usersData = JSON.parse(jsonUsers);\n    (0, $iVdgJ.renderMonthYearSelect)();\n    $e80396a3d35d2658$var$formatUsersData($e80396a3d35d2658$var$usersData);\n    $e80396a3d35d2658$var$updateCalendar();\n    document.getElementById(\"back-button\").addEventListener(\"click\", ()=>{\n        window.location.href = backurl;\n    });\n    document.getElementById(\"month\").addEventListener(\"change\", ()=>$e80396a3d35d2658$var$updateCalendar());\n    document.getElementById(\"year\").addEventListener(\"change\", ()=>$e80396a3d35d2658$var$updateCalendar());\n    document.getElementById(\"onlySelected\").addEventListener(\"click\", ()=>{\n        $e80396a3d35d2658$var$renderCalendarPreview($e80396a3d35d2658$var$formattedUsers.filter((user)=>user.name !== document.getElementById(\"nameInput\")?.value?.trim()));\n        document.getElementById(\"customModal\").classList.add(\"hidden\");\n    });\n    document.getElementById(\"cancel\").addEventListener(\"click\", ()=>{\n        document.getElementById(\"customModal\").classList.add(\"hidden\");\n    });\n    document.getElementById(\"show-preview-button\").addEventListener(\"click\", function() {\n        const specificPerson = document.getElementById(\"nameInput\")?.value?.trim();\n        const isSpecificPersonInUsersArray = $e80396a3d35d2658$var$usersData?.find((user)=>user === specificPerson);\n        if (isSpecificPersonInUsersArray) {\n            $e80396a3d35d2658$var$showCustomModal(specificPerson);\n            return;\n        }\n        if ($e80396a3d35d2658$var$teamdays.length !== 0 && !specificPerson) {\n            alert((0, $kaKyP.default)(\"create.specificPersonMissing\"));\n            return;\n        }\n        $e80396a3d35d2658$var$renderCalendarPreview();\n    });\n    document.getElementById(\"back-creation-button\").addEventListener(\"click\", function() {\n        document.getElementById(\"plan-creation-container\").classList.remove(\"hidden\");\n        document.getElementById(\"calendar-preview-container\").classList.add(\"hidden\");\n    });\n    document.querySelectorAll(\".weekday-checkbox\").forEach((checkbox)=>{\n        checkbox.addEventListener(\"change\", ()=>{\n            $e80396a3d35d2658$var$updateCalendar();\n        });\n    });\n}\nfunction $e80396a3d35d2658$var$formatUsersData(users) {\n    $e80396a3d35d2658$var$formattedUsers = users.map((user)=>({\n            name: user,\n            not_available: []\n        }));\n}\nfunction $e80396a3d35d2658$var$renderCalendarPreview(subsetFormattedUsers) {\n    document.getElementById(\"plan-creation-container\").classList.add(\"hidden\");\n    document.getElementById(\"calendar-preview-container\").classList.remove(\"hidden\");\n    const usersToAssign = subsetFormattedUsers ?? $e80396a3d35d2658$var$formattedUsers;\n    const month = parseInt(document.getElementById(\"month\").value) + 1;\n    const year = parseInt(document.getElementById(\"year\").value);\n    const selectedWeekdays = Array.from(document.querySelectorAll(\".weekday-checkbox:checked\")).map((checkbox)=>$e80396a3d35d2658$var$WEEKDAY_MAPPING[checkbox.value]);\n    const options = {\n        weekdays: selectedWeekdays,\n        holidays: $e80396a3d35d2658$var$holidays,\n        kitaOpenNoEd: $e80396a3d35d2658$var$kitaOpenNoEd,\n        teamdays: $e80396a3d35d2658$var$teamdays,\n        specificPerson: document.getElementById(\"nameInput\")?.value\n    };\n    const shiftValue = document.querySelector('input[name=\"shifts-per-day\"]:checked')?.value ?? 2;\n    $e80396a3d35d2658$var$calendar = (0, $VIWgv.assignUsersCalendar)(month, year, usersToAssign, options, Number(shiftValue));\n    $e80396a3d35d2658$var$renderPdfPreview(month, year);\n}\nfunction $e80396a3d35d2658$var$renderPdfPreview(month, year) {\n    const previewBody = document.getElementById(\"calendar-preview-table\");\n    const twoColHeader = document.getElementById(\"tableheadersTwoCols\");\n    const threeColHeader = document.getElementById(\"tableheadersThreeCols\");\n    previewBody.innerHTML = \"\";\n    twoColHeader.classList.add(\"hidden\");\n    threeColHeader.classList.remove(\"hidden\");\n    previewBody.appendChild(twoColHeader);\n    previewBody.appendChild(threeColHeader);\n    const calendarEntries = Object.entries($e80396a3d35d2658$var$calendar).map(([day, { parents: parents, isKitaOpenNoEd: isKitaOpenNoEd, isAssigned: isAssigned, isValidDay: isValidDay, invalidText: invalidText, specificPerson: specificPerson }])=>({\n            day: day,\n            parents: parents,\n            meta: {\n                isAssigned: isAssigned,\n                isValidDay: isValidDay,\n                invalidText: invalidText,\n                isKitaOpenNoEd: isKitaOpenNoEd,\n                specificPerson: specificPerson\n            }\n        }));\n    const parentCount = {};\n    calendarEntries.forEach(({ parents: parents, meta: meta })=>{\n        if (meta.specificPerson) parentCount[meta.specificPerson] = (parentCount[parent] || 0) + 1;\n        parents.forEach((parent1)=>{\n            if (meta.isValidDay && parent1 && parent1 !== (0, $kaKyP.default)(\"create.notSet\")) parentCount[parent1] = (parentCount[parent1] || 0) + 1;\n        });\n    });\n    const summaryDiv = document.getElementById(\"parent-summary\");\n    summaryDiv.innerHTML = \"\";\n    Object.entries(parentCount).sort(([a], [b])=>a.localeCompare(b)).forEach(([parent1, count])=>{\n        const summaryItem = document.createElement(\"div\");\n        summaryItem.classList.add(\"flex\", \"justify-between\", \"py-1\", \"cursor-pointer\");\n        summaryItem.innerHTML = `\n                <span class=\"font-medium text-gray-800\">${parent1}</span>\n                <span class=\"text-gray-600\">(${count})</span>\n            `;\n        summaryItem.addEventListener(\"click\", ()=>{\n            document.querySelectorAll(\"#parent-summary > div\").forEach((item)=>item.classList.remove(\"bg-green-200\"));\n            summaryItem.classList.add(\"bg-green-200\");\n            const selects = document.querySelectorAll(\"#calendar-preview-table select\");\n            selects.forEach((select)=>{\n                if (select.value === parent1) select.classList.add(\"bg-green-200\");\n                else select.classList.remove(\"bg-green-200\");\n            });\n        });\n        summaryDiv.appendChild(summaryItem);\n    });\n    for (const entry of calendarEntries){\n        const { day: day, parents: parents, meta: meta } = entry;\n        const flexContainer = document.createElement(\"div\");\n        flexContainer.classList.add(\"flex\", \"flex-col\", \"md:flex-row\", \"w-full\", \"py-1\", \"border\");\n        const rowDayDiv = document.createElement(\"div\");\n        rowDayDiv.textContent = (0, $dVfXR.formatDayOfWeek)(day, month, year);\n        rowDayDiv.classList.add(\"w-full\", \"md:w-1/12\", \"text-left\");\n        const rowDateDiv = document.createElement(\"div\");\n        rowDateDiv.textContent = (0, $dVfXR.formatDate)(day, month, year);\n        rowDateDiv.classList.add(\"w-full\", \"md:w-1/6\", \"text-left\");\n        flexContainer.appendChild(rowDayDiv);\n        flexContainer.appendChild(rowDateDiv);\n        if (meta.isKitaOpenNoEd) {\n            flexContainer.classList.add(\"bg-yellow-200\");\n            const invalidDayInput = document.createElement(\"input\");\n            invalidDayInput.type = \"text\";\n            invalidDayInput.value = $e80396a3d35d2658$var$calendar[day].invalidText || \"\";\n            invalidDayInput.classList.add(\"flex-1\", \"text-center\", \"bg-yellow-200\");\n            invalidDayInput.setAttribute(\"tabindex\", \"0\");\n            invalidDayInput.addEventListener(\"change\", ()=>{\n                $e80396a3d35d2658$var$calendar[day].invalidText = invalidDayInput.value.trim();\n                $e80396a3d35d2658$var$renderPdfPreview(month, year);\n            });\n            flexContainer.appendChild(invalidDayInput);\n        } else if (!meta.isValidDay) {\n            flexContainer.classList.add(\"bg-red-200\");\n            const invalidDayInput = document.createElement(\"input\");\n            invalidDayInput.type = \"text\";\n            invalidDayInput.value = $e80396a3d35d2658$var$calendar[day].invalidText || \"\";\n            invalidDayInput.classList.add(\"flex-1\", \"text-center\", \"bg-red-200\");\n            invalidDayInput.setAttribute(\"tabindex\", \"0\");\n            invalidDayInput.addEventListener(\"change\", ()=>{\n                $e80396a3d35d2658$var$calendar[day].invalidText = invalidDayInput.value.trim();\n                $e80396a3d35d2658$var$renderPdfPreview(month, year);\n            });\n            flexContainer.appendChild(invalidDayInput);\n        } else {\n            parents.forEach((parent1, index)=>{\n                const user3Select = document.createElement(\"select\");\n                user3Select.classList.add(\"flex-1\", \"text-left\", \"cursor-pointer\");\n                if (!$e80396a3d35d2658$var$usersData.find((user)=>user === parent1)) user3Select.classList.add(\"bg-yellow-200\");\n                const noSelectionUser3 = document.createElement(\"option\");\n                const textNotSet = (0, $kaKyP.default)(\"create.notSet\");\n                noSelectionUser3.value = textNotSet;\n                noSelectionUser3.textContent = textNotSet;\n                if (parent1 === textNotSet) noSelectionUser3.selected = true;\n                user3Select.appendChild(noSelectionUser3);\n                $e80396a3d35d2658$var$usersData.forEach((user)=>{\n                    const option = document.createElement(\"option\");\n                    option.value = user;\n                    option.textContent = user;\n                    if (user === parent1) option.selected = true;\n                    user3Select.appendChild(option);\n                });\n                user3Select.addEventListener(\"change\", ()=>{\n                    const isSet = user3Select.value !== textNotSet;\n                    const naDateArray = $e80396a3d35d2658$var$formattedUsers.find((fUser)=>fUser.name === user3Select.value)?.not_available || [];\n                    let continueProcess = true;\n                    if (isSet && naDateArray.includes(`${year}-${month}-${day}`)) continueProcess = confirm((0, $kaKyP.default)(\"create.personNotAvailableAlert\"));\n                    if (continueProcess) $e80396a3d35d2658$var$calendar[day].parents[index] = user3Select.value;\n                    else user3Select.value = $e80396a3d35d2658$var$calendar[day].parents[index];\n                    $e80396a3d35d2658$var$renderPdfPreview(month, year);\n                });\n                flexContainer.appendChild(user3Select);\n            });\n            if (meta.specificPerson) {\n                const user3Select = document.createElement(\"select\");\n                user3Select.classList.add(\"flex-1\", \"text-left\", \"cursor-pointer\");\n                const teamOption = document.createElement(\"option\");\n                teamOption.value = meta.specificPerson;\n                teamOption.textContent = meta.specificPerson;\n                teamOption.selected = true;\n                user3Select.appendChild(teamOption);\n                user3Select.disabled = true;\n                user3Select.value = meta.specificPerson;\n                user3Select.classList.add(\"cursor-not-allowed\");\n                flexContainer.appendChild(user3Select);\n            }\n        }\n        previewBody.appendChild(flexContainer);\n    }\n}\ndocument.getElementById(\"preview-button\").addEventListener(\"click\", ()=>{\n    $e80396a3d35d2658$var$renderCalendarPreview();\n    console.log(\"Preview updated\");\n});\nfunction $e80396a3d35d2658$var$updateCalendar() {\n    $e80396a3d35d2658$var$formattedUsers.forEach((user)=>user.not_available = []);\n    $e80396a3d35d2658$var$holidays = [];\n    $e80396a3d35d2658$var$teamdays = [];\n    $e80396a3d35d2658$var$kitaOpenNoEd = [];\n    $e80396a3d35d2658$var$selectedWeekdays = Array.from(document.querySelectorAll(\".weekday-checkbox:checked\")).map((checkbox)=>checkbox.value);\n    $e80396a3d35d2658$var$populateUserTable($e80396a3d35d2658$var$formattedUsers);\n    $e80396a3d35d2658$var$updateHolidayCalendar();\n    $e80396a3d35d2658$var$updateKitaOpenNoEdCalendar();\n    $e80396a3d35d2658$var$updateTeamTakesSlotCalendar();\n}\nfunction $e80396a3d35d2658$var$populateUserTable(users) {\n    const userTableBody = document.getElementById(\"user-table-body\");\n    userTableBody.innerHTML = \"\";\n    const month = document.getElementById(\"month\").value;\n    const year = document.getElementById(\"year\").value;\n    users.sort((a, b)=>a?.name?.localeCompare(b?.name)).forEach((user)=>{\n        const row = document.createElement(\"tr\");\n        row.classList.add(\"border-b\");\n        const userCell = document.createElement(\"td\");\n        userCell.classList.add(\"p-4\", \"border\", \"border-gray-300\", \"rounded-lg\");\n        const userNameElement = document.createElement(\"div\");\n        userNameElement.textContent = user.name;\n        userNameElement.classList.add(\"font-semibold\", \"text-lg\", \"mb-2\", \"text-gray-800\", \"p-2\", \"bg-gray-100\", \"rounded-md\");\n        userCell.appendChild(userNameElement);\n        const jsonInput = document.createElement(\"input\");\n        jsonInput.type = \"text\";\n        jsonInput.placeholder = (0, $kaKyP.default)(\"create.insertBlockedTime\");\n        jsonInput.classList.add(\"w-full\", \"p-2\", \"border\", \"border-gray-300\", \"rounded-md\", \"mt-2\", \"focus:outline-none\", \"focus:ring-2\", \"focus:ring-blue-500\", \"bg-white\");\n        const confirmButton = document.createElement(\"button\");\n        confirmButton.textContent = (0, $kaKyP.default)(\"create.confirm\");\n        confirmButton.classList.add(\"mt-2\", \"px-4\", \"py-2\", \"bg-blue-500\", \"text-white\", \"rounded-md\", \"hover:bg-blue-600\", \"focus:outline-none\", \"focus:ring-2\", \"focus:ring-blue-500\");\n        confirmButton.addEventListener(\"click\", function() {\n            try {\n                const jsonData = JSON.parse(jsonInput.value);\n                if (Array.isArray(jsonData)) {\n                    const dateRegex = /^\\d{4}-\\d{1,2}-\\d{1,2}$/;\n                    const isValid = jsonData.every((item)=>typeof item === 'string' && dateRegex.test(item));\n                    if (isValid) {\n                        user.not_available = jsonData;\n                        $e80396a3d35d2658$var$populateUserTable(users);\n                    } else alert((0, $kaKyP.default)(\"create.dateStringInvalidDates\"));\n                } else alert((0, $kaKyP.default)(\"create.dateStringInvalidList\"));\n            } catch (error) {\n                console.log(error);\n                alert((0, $kaKyP.default)(\"create.generalError\"));\n            }\n        });\n        userCell.appendChild(jsonInput);\n        userCell.appendChild(confirmButton);\n        row.appendChild(userCell);\n        const calendarCell = document.createElement(\"td\");\n        calendarCell.classList.add(\"p-2\");\n        const daysContainer = document.createElement(\"div\");\n        daysContainer.classList.add(\"calendar\");\n        const daysOfWeek = [\n            (0, $kaKyP.default)(\"daysShort.mo\"),\n            (0, $kaKyP.default)(\"daysShort.di\"),\n            (0, $kaKyP.default)(\"daysShort.mi\"),\n            (0, $kaKyP.default)(\"daysShort.do\"),\n            (0, $kaKyP.default)(\"daysShort.fr\"),\n            (0, $kaKyP.default)(\"daysShort.sa\"),\n            (0, $kaKyP.default)(\"daysShort.so\")\n        ];\n        daysOfWeek.forEach((day)=>{\n            const dayHeader = document.createElement(\"div\");\n            dayHeader.classList.add(\"calendar-header\");\n            dayHeader.textContent = day;\n            daysContainer.appendChild(dayHeader);\n        });\n        const firstDayOfMonth = new Date(year, parseInt(month), 1).getDay();\n        const firstDayAdjusted = (firstDayOfMonth + 6) % 7;\n        for(let i = 0; i < firstDayAdjusted; i++){\n            const emptyCell = document.createElement(\"div\");\n            emptyCell.classList.add(\"calendar-day\");\n            daysContainer.appendChild(emptyCell);\n        }\n        const daysInMonth = new Date(year, parseInt(month) + 1, 0).getDate();\n        for(let day = 1; day <= daysInMonth; day++){\n            const dayButton = document.createElement(\"div\");\n            dayButton.classList.add(\"calendar-day\");\n            dayButton.textContent = day.toString();\n            const dayOfWeek = new Date(year, parseInt(month), day).getDay();\n            const dayName = daysOfWeek[dayOfWeek - 1];\n            if (!$e80396a3d35d2658$var$selectedWeekdays.includes(dayName)) {\n                dayButton.classList.add(\"excluded\");\n                dayButton.style.cursor = \"default\";\n            } else {\n                const isNotAvailable = user.not_available.includes(`${year}-${parseInt(month) + 1}-${day}`);\n                if (isNotAvailable) dayButton.classList.add(\"not-available\");\n                dayButton.addEventListener(\"click\", ()=>{\n                    const dateKey = `${year}-${parseInt(month) + 1}-${day}`;\n                    const isCurrentlyNotAvailable = user.not_available.includes(dateKey);\n                    if (isCurrentlyNotAvailable) {\n                        user.not_available = user.not_available.filter((date)=>date !== dateKey);\n                        dayButton.classList.remove(\"not-available\");\n                    } else {\n                        user.not_available.push(dateKey);\n                        dayButton.classList.add(\"not-available\");\n                    }\n                });\n            }\n            daysContainer.appendChild(dayButton);\n        }\n        calendarCell.appendChild(daysContainer);\n        row.appendChild(calendarCell);\n        userTableBody.appendChild(row);\n    });\n}\nfunction $e80396a3d35d2658$var$updateHolidayCalendar() {\n    $e80396a3d35d2658$var$updateGenericCalender(\"holidays-calendar\", $e80396a3d35d2658$var$holidays);\n}\nfunction $e80396a3d35d2658$var$updateKitaOpenNoEdCalendar() {\n    $e80396a3d35d2658$var$updateGenericCalender(\"kitaOpenNoEd-calendar\", $e80396a3d35d2658$var$kitaOpenNoEd);\n}\nfunction $e80396a3d35d2658$var$updateTeamTakesSlotCalendar() {\n    $e80396a3d35d2658$var$updateGenericCalender(\"team-calendar\", $e80396a3d35d2658$var$teamdays);\n}\nfunction $e80396a3d35d2658$var$updateGenericCalender(id, subjectArray) {\n    const month = document.getElementById(\"month\").value;\n    const year = document.getElementById(\"year\").value;\n    const subjectCalendar = document.getElementById(id);\n    subjectCalendar.innerHTML = \"\";\n    const daysOfWeek = [\n        (0, $kaKyP.default)(\"daysShort.mo\"),\n        (0, $kaKyP.default)(\"daysShort.di\"),\n        (0, $kaKyP.default)(\"daysShort.mi\"),\n        (0, $kaKyP.default)(\"daysShort.do\"),\n        (0, $kaKyP.default)(\"daysShort.fr\"),\n        (0, $kaKyP.default)(\"daysShort.sa\"),\n        (0, $kaKyP.default)(\"daysShort.so\")\n    ];\n    daysOfWeek.forEach((day)=>{\n        const dayHeader = document.createElement(\"div\");\n        dayHeader.classList.add(\"calendar-header\");\n        dayHeader.textContent = day;\n        subjectCalendar.appendChild(dayHeader);\n    });\n    const firstDayOfMonth = new Date(year, parseInt(month), 1).getDay();\n    const firstDayAdjusted = (firstDayOfMonth + 6) % 7;\n    for(let i = 0; i < firstDayAdjusted; i++){\n        const emptyCell = document.createElement(\"div\");\n        emptyCell.classList.add(\"calendar-day\");\n        subjectCalendar.appendChild(emptyCell);\n    }\n    const daysInMonth = new Date(year, parseInt(month) + 1, 0).getDate();\n    for(let day = 1; day <= daysInMonth; day++){\n        const dayButton = document.createElement(\"div\");\n        dayButton.classList.add(\"calendar-day\");\n        dayButton.textContent = day.toString();\n        const dayOfWeek = new Date(year, parseInt(month), day).getDay();\n        const dayName = daysOfWeek[dayOfWeek - 1];\n        if (!$e80396a3d35d2658$var$selectedWeekdays.includes(dayName)) {\n            dayButton.classList.add(\"excluded\");\n            dayButton.style.cursor = \"default\";\n        } else {\n            const isSubject = subjectArray.includes(`${year}-${parseInt(month) + 1}-${day}`);\n            if (isSubject) dayButton.classList.add(\"not-available\");\n            dayButton.addEventListener(\"click\", ()=>{\n                const dateKey = `${year}-${parseInt(month) + 1}-${day}`;\n                const isCurrentlySubject = subjectArray.includes(dateKey);\n                if (isCurrentlySubject) {\n                    const index = subjectArray.indexOf(dateKey);\n                    if (index > -1) subjectArray.splice(index, 1);\n                    dayButton.classList.remove(\"not-available\");\n                } else {\n                    subjectArray.push(dateKey);\n                    dayButton.classList.add(\"not-available\");\n                }\n            });\n        }\n        subjectCalendar.appendChild(dayButton);\n    }\n}\ndocument.getElementById(\"generate-pdf-button\").addEventListener(\"click\", async ()=>{\n    const month = parseInt(document.getElementById(\"month\").value) + 1;\n    const year = parseInt(document.getElementById(\"year\").value);\n    try {\n        if (!$e80396a3d35d2658$var$calendar || Object.entries($e80396a3d35d2658$var$calendar).length === 0) {\n            (0, $iVdgJ.displayError)((0, $kaKyP.default)(\"create.forceUpdatePreview\"));\n            return;\n        }\n        let fileBlob;\n        const shiftValue = document.querySelector('input[name=\"shifts-per-day\"]:checked')?.value;\n        let isKita = false;\n        if (shiftValue === \"3\") fileBlob = (0, $dVfXR.generateShiftplanPdf)($e80396a3d35d2658$var$calendar, month, year, $e80396a3d35d2658$var$usersData, isKita, 3);\n        else if (shiftValue === \"2\") fileBlob = (0, $dVfXR.generateShiftplanPdf)($e80396a3d35d2658$var$calendar, month, year, $e80396a3d35d2658$var$usersData, isKita, 2);\n        else {\n            isKita = true;\n            fileBlob = (0, $dVfXR.generateShiftplanPdf)($e80396a3d35d2658$var$calendar, month, year, $e80396a3d35d2658$var$usersData, isKita, 2);\n        }\n        const downloadLink = document.createElement(\"a\");\n        downloadLink.href = URL.createObjectURL(fileBlob);\n        downloadLink.download = isKita ? `${(0, $kaKyP.default)(\"create.kitaplanpdf\")}_${year}_${month}.pdf` : `${(0, $kaKyP.default)(\"create.shiftplanpdf\")}_${year}_${month}.pdf`;\n        document.body.appendChild(downloadLink);\n        downloadLink.click();\n        document.body.removeChild(downloadLink);\n        console.log(\"PDF generated successfully\");\n    } catch (error) {\n        console.error(error.message);\n    }\n});\nfunction $e80396a3d35d2658$var$showCustomModal(personName) {\n    document.getElementById(\"modalText\").innerHTML = `\n    ${personName} ${(0, $kaKyP.default)(\"create.specialshiftsInfo\")}`;\n    document.getElementById(\"customModal\").classList.remove(\"hidden\");\n}\n\n});\nparcelRegister(\"dVfXR\", function(module, exports) {\n\n$parcel$export(module.exports, \"formatDate\", () => $a22cfb7663804a46$export$3ae94a2503e890a1);\n$parcel$export(module.exports, \"formatDayOfWeek\", () => $a22cfb7663804a46$export$f484d8a20c1ae790);\n$parcel$export(module.exports, \"generateShiftplanPdf\", () => $a22cfb7663804a46$export$22d5759ea413b875);\n\nvar $kaKyP = parcelRequire(\"kaKyP\");\nfunction $a22cfb7663804a46$export$3ae94a2503e890a1(day, month, year) {\n    const date = new Date(year, month - 1, day);\n    return window.dateFns.format(date, 'dd.MM', {\n        locale: window.dateFns.locale.de\n    });\n}\nfunction $a22cfb7663804a46$export$f484d8a20c1ae790(day, month, year) {\n    const date = new Date(year, month - 1, day);\n    const formattedDay = window.dateFns.format(date, 'EE', {\n        locale: window.dateFns.locale.de\n    });\n    return formattedDay.endsWith(\".\") ? formattedDay.slice(0, -1) : formattedDay;\n}\nfunction $a22cfb7663804a46$var$getHeaders(isKita, cols) {\n    if (isKita || cols === 2) {\n        const schicht1 = isKita ? `${(0, $kaKyP.default)(\"create.family\")} 1` : localStorage.getItem('twocol-label-1') || `${(0, $kaKyP.default)(\"create.shift\")} 1`;\n        const schicht2 = isKita ? `${(0, $kaKyP.default)(\"create.family\")} 2` : localStorage.getItem('twocol-label-2') || `${(0, $kaKyP.default)(\"create.shift\")} 2`;\n        return [\n            [\n                (0, $kaKyP.default)(\"create.day\"),\n                (0, $kaKyP.default)(\"create.date\"),\n                schicht1,\n                schicht2\n            ]\n        ];\n    }\n    // Überschrift der Tabelle (Header) – hier bleiben wir bei 5 Zellen, da autoTable Body-Zeilen über colSpan korrekt zusammenführt.\n    const schicht1 = localStorage.getItem('threecol-label-1') || `${(0, $kaKyP.default)(\"create.shift\")} 1`;\n    const schicht2 = localStorage.getItem('threecol-label-2') || `${(0, $kaKyP.default)(\"create.shift\")} 2`;\n    const schicht3 = localStorage.getItem('threecol-label-3') || `${(0, $kaKyP.default)(\"create.shift\")} 3`;\n    return [\n        [\n            (0, $kaKyP.default)(\"create.day\"),\n            (0, $kaKyP.default)(\"create.date\"),\n            schicht1,\n            schicht2,\n            schicht3\n        ]\n    ];\n}\nfunction $a22cfb7663804a46$export$22d5759ea413b875(calendar, month, year, usersData = [], isKita, cols) {\n    const { jsPDF: jsPDF } = window.jspdf;\n    const doc = new jsPDF();\n    // Titel und Untertitel zentrieren\n    const title = isKita ? (0, $kaKyP.default)(\"create.kitashiftplan\") : (0, $kaKyP.default)(\"create.shiftplan\");\n    doc.setFontSize(16);\n    doc.text(title, doc.internal.pageSize.getWidth() / 2, 15, {\n        align: 'center'\n    });\n    doc.setFontSize(12);\n    doc.text(`${window.dateFns.format(new Date(year, month - 1), 'MMMM yyyy', {\n        locale: window.dateFns.locale.de\n    })}`, doc.internal.pageSize.getWidth() / 2, 22, {\n        align: 'center'\n    });\n    const legendStartY = 28;\n    const pageWidth = doc.internal.pageSize.getWidth();\n    const legendLeftMargin = (pageWidth - 150) / 2;\n    const boxSize = 6;\n    // Legende: Gelber Kasten\n    doc.setFillColor(255, 230, 153);\n    doc.rect(legendLeftMargin, legendStartY, boxSize, boxSize, 'F');\n    doc.setTextColor(0, 0, 0);\n    doc.setFontSize(10);\n    const noShiftNecessaryInfo = isKita ? (0, $kaKyP.default)(\"create.kitashiftplanOpenInfo\") : (0, $kaKyP.default)(\"create.shiftplanOpenInfo\");\n    doc.text(noShiftNecessaryInfo, legendLeftMargin + boxSize + 5, legendStartY + boxSize - 1);\n    // Legende: Roter Kasten\n    const redBoxX = legendLeftMargin + 90;\n    doc.setFillColor(255, 204, 204);\n    doc.rect(redBoxX, legendStartY, boxSize, boxSize, 'F');\n    doc.text((0, $kaKyP.default)(\"create.closedInfo\"), redBoxX + boxSize + 5, legendStartY + boxSize - 1);\n    let startY = legendStartY + 10;\n    let actionTaken = false;\n    const rows = [];\n    for(const day in calendar){\n        let { parents: parents, isValidDay: isValidDay, isKitaOpenNoEd: isKitaOpenNoEd, isAssigned: isAssigned, invalidText: invalidText, specificPerson: specificPerson } = calendar[day];\n        if (!actionTaken) {\n            const areAllUsersKnown = parents.reduce((acc, currParent)=>{\n                // if one user was not found, the boolean should be persisted\n                if (acc === false) return false;\n                return !!usersData.find((user)=>user === currParent);\n            }, true);\n            if (isValidDay && !areAllUsersKnown) {\n                const confirmedChoice = confirm(`${(0, $kaKyP.default)(\"create.personNotFoundOne\")} ${parents.join(\", \")}. ${(0, $kaKyP.default)(\"create.personNotFoundTwo\")}`);\n                if (!confirmedChoice) return;\n                actionTaken = true;\n            }\n        }\n        const formattedDate = $a22cfb7663804a46$export$3ae94a2503e890a1(day, month, year);\n        const dayOfWeek = $a22cfb7663804a46$export$f484d8a20c1ae790(day, month, year);\n        // Bei gültigen Tagen wird der Inhalt aus der ersten Spalte übernommen.\n        // Für ungültige Tage (z.B. Feiertage) bzw. \"KitaOpenNoEd\" nutzen wir später einen fixen Text.\n        parents.forEach((value, index)=>{\n            if (value === (0, $kaKyP.default)(\"create.notSet\")) parents[index] = \"\";\n        });\n        const parentCols = specificPerson ? [\n            ...parents,\n            specificPerson\n        ] : parents;\n        // Speichere die Zeile inklusive Meta-Daten\n        if (!isValidDay) console.log(parents, dayOfWeek, formattedDate, isKitaOpenNoEd, isAssigned, isValidDay, invalidText, specificPerson);\n        rows.push({\n            data: [\n                dayOfWeek,\n                formattedDate,\n                ...parentCols\n            ],\n            meta: {\n                isKitaOpenNoEd: isKitaOpenNoEd,\n                isAssigned: isAssigned,\n                isValidDay: isValidDay,\n                invalidText: invalidText,\n                specificPerson: specificPerson\n            }\n        });\n    }\n    // Neuer Body‑Array, der für spezielle Tage (nicht valide oder KitaOpenNoEd) die Schicht-Spalten zusammenfasst:\n    const tableBody = rows.map((row)=>{\n        if (!row.meta.isValidDay || row.meta.isKitaOpenNoEd) {\n            let specialText = row.meta.invalidText ?? \"\";\n            let fillColor = row.meta.isKitaOpenNoEd ? [\n                255,\n                230,\n                153\n            ] : [\n                255,\n                204,\n                204\n            ];\n            return [\n                row.data[0],\n                row.data[1],\n                {\n                    content: specialText,\n                    colSpan: cols,\n                    styles: {\n                        halign: 'center',\n                        fillColor: fillColor,\n                        textColor: [\n                            50,\n                            50,\n                            50\n                        ]\n                    }\n                }\n            ];\n        } else // Normale Zeile: 5 Spalten, ohne Veränderung\n        return row.data;\n    });\n    const headers = $a22cfb7663804a46$var$getHeaders(isKita, cols);\n    // Gesamte Tabellenspaltenbreiten (aus Column-Styles)\n    // Spalte 0: 10, Spalte 1: 20, Spalte 2: 60, Spalte 3: 50, Spalte 4: 50 => Summe = 190\n    const wantedTableWidth = cols === 2 ? 150 : 190;\n    const margin = (pageWidth - wantedTableWidth) / 2;\n    /*\ncolumnStyles 2 cols\ncolumnStyles: {\n            0: {cellWidth: 20},\n            1: {cellWidth: 30},\n            2: {cellWidth: 50},\n\n\n            3: {cellWidth: 50}\n        },\n */ // Aufruf von autoTable – alternativ: Für normale Zeilen nutzen wir das Alternating Row Style\n    doc.autoTable({\n        head: headers,\n        body: tableBody,\n        startY: startY,\n        theme: 'grid',\n        headStyles: {\n            fillColor: [\n                100,\n                100,\n                255\n            ]\n        },\n        alternateRowStyles: {\n            fillColor: [\n                245,\n                245,\n                245\n            ]\n        },\n        bodyStyles: {\n            halign: 'center'\n        },\n        columnStyles: {\n            0: {\n                cellWidth: 10\n            },\n            1: {\n                cellWidth: 20\n            },\n            2: {\n                cellWidth: 60\n            },\n            3: {\n                cellWidth: 50\n            },\n            4: {\n                cellWidth: 50\n            }\n        },\n        margin: {\n            left: margin,\n            right: margin\n        }\n    });\n    return doc.output('blob');\n}\n\n});\n\nparcelRegister(\"VIWgv\", function(module, exports) {\n\n$parcel$export(module.exports, \"assignUsersCalendar\", () => $0ad82ee3386c69da$export$3b73c77273a86041);\n\nvar $kaKyP = parcelRequire(\"kaKyP\");\n\nvar $iVdgJ = parcelRequire(\"iVdgJ\");\n// Function to update the selected user's data (service count and prio)\nfunction $0ad82ee3386c69da$var$updateUsersArray(_users, averageServiceCount, hasEnoughUsers, selectedUser) {\n    if (hasEnoughUsers) _users.forEach((user)=>{\n        if (user.name === selectedUser.name) {\n            // Update service count and adjust priority\n            const newServiceCount = user.serviceCount + 1;\n            let newPrio;\n            if (newServiceCount >= averageServiceCount) newPrio = 1000;\n            else if (user.prioOffsetFactor === 0) newPrio = -1000;\n            else newPrio = 10 * user.prioOffsetFactor;\n            user.prio = newPrio;\n            user.serviceCount = newServiceCount;\n        } else user.prio = user.prio === 1000 ? 1000 : user.prio === -1000 ? -1000 : user.prio - 10;\n    });\n}\n// Helper functions zur Prüfung der Tage\nfunction $0ad82ee3386c69da$var$isKitaOpenNoEd(year, month, day, kitaOpenNoEd) {\n    const formattedDate = `${year}-${month}-${day}`;\n    return kitaOpenNoEd.includes(formattedDate);\n}\nfunction $0ad82ee3386c69da$var$isHoliday(year, month, day, holidays) {\n    const formattedDate = `${year}-${month}-${day}`;\n    return holidays.includes(formattedDate);\n}\nfunction $0ad82ee3386c69da$var$isTeamDay(year, month, day, teamdays) {\n    const formattedDate = `${year}-${month}-${day}`;\n    return teamdays.includes(formattedDate);\n}\nfunction $0ad82ee3386c69da$var$isValidWeekday(year, month, day, weekdays) {\n    const date = new Date(year, month - 1, day);\n    const weekday = date.toLocaleDateString('en-US', {\n        weekday: 'long'\n    });\n    return weekdays.includes(weekday);\n}\n// Berechne die Anzahl der Tage, an denen ein Dienst stattfindet\nfunction $0ad82ee3386c69da$var$calcUniqueServiceDays(year, month, daysInMonth, kitaOpenNoEd, holidays, weekdays) {\n    let total = 0;\n    for(let day = 1; day <= daysInMonth; day++){\n        // Skip days where Kita is open without education,\n        // invalid weekdays, or holidays in one combined check\n        if ($0ad82ee3386c69da$var$isKitaOpenNoEd(year, month, day, kitaOpenNoEd) || !$0ad82ee3386c69da$var$isValidWeekday(year, month, day, weekdays) || $0ad82ee3386c69da$var$isHoliday(year, month, day, holidays)) continue;\n        total++;\n    }\n    return total;\n}\nfunction $0ad82ee3386c69da$var$isUserAvailable(user, dateString) {\n    return !user.not_available.includes(dateString);\n}\nfunction $0ad82ee3386c69da$var$getAvailableUsersForDay(year, month, day, localUsers) {\n    const dateString = `${year}-${month}-${day}`;\n    return localUsers.filter((user)=>$0ad82ee3386c69da$var$isUserAvailable(user, dateString));\n}\nfunction $0ad82ee3386c69da$var$pickUsers(usersSortedByPrio, requiredCount) {\n    const picks = usersSortedByPrio.slice(0, requiredCount);\n    while(picks.length < requiredCount)picks.push({\n        name: (0, $kaKyP.default)(\"create.notSet\")\n    });\n    return picks;\n}\nfunction $0ad82ee3386c69da$export$3b73c77273a86041(month, year, localUsers, options = {}, cols) {\n    const calendar = {}; // Kalenderspeicher\n    const { weekdays: weekdays = [\n        'Monday',\n        'Tuesday',\n        'Wednesday',\n        'Thursday',\n        'Friday'\n    ], holidays: holidays = [], kitaOpenNoEd: kitaOpenNoEd = [], teamdays: teamdays = [] } = options;\n    const daysInMonth = new Date(year, month, 0).getDate();\n    const uniqueServiceDays = $0ad82ee3386c69da$var$calcUniqueServiceDays(year, month, daysInMonth, kitaOpenNoEd, holidays, weekdays);\n    // Anpassen: Berechne den Durchschnitt anhand von 3 Schicht-Spalten (statt 2)\n    // #Duplicate von oben bis hier.\n    // # 3 mit arg ersetzen\n    const averageServiceCount = Math.floor(uniqueServiceDays * cols / localUsers.length);\n    // Kopiere und erweitere die Nutzer-Daten\n    const _users = [\n        ...localUsers\n    ].map((user)=>{\n        const cleanedNotAvailableArray = user[\"not_available\"].filter((date)=>{\n            const extractedDay = date.split(\"-\")[2];\n            if (extractedDay === undefined) return false;\n            if ($0ad82ee3386c69da$var$isHoliday(year, month, extractedDay, holidays)) return false;\n            if ($0ad82ee3386c69da$var$isKitaOpenNoEd(year, month, extractedDay, kitaOpenNoEd)) return false;\n            return $0ad82ee3386c69da$var$isValidWeekday(year, month, extractedDay, weekdays);\n        });\n        const availableTotal = uniqueServiceDays - cleanedNotAvailableArray.length;\n        const prioOffsetFactor = availableTotal <= uniqueServiceDays / 4 ? 0 : availableTotal <= uniqueServiceDays / 2 ? 2 : 1;\n        return {\n            ...user,\n            \"not_available\": cleanedNotAvailableArray,\n            serviceCount: 0,\n            prioOffsetFactor: prioOffsetFactor,\n            // Der niedrigere Wert = höhere Chance ausgewählt zu werden\n            prio: availableTotal <= uniqueServiceDays / 4 ? -1000 : -10 * prioOffsetFactor\n        };\n    });\n    for(let day = 1; day <= daysInMonth; day++){\n        // Sonderfälle: Tage, an denen kein Dienst stattfindet\n        const parents = Array(cols).fill(\"\");\n        if ($0ad82ee3386c69da$var$isKitaOpenNoEd(year, month, day, kitaOpenNoEd)) {\n            calendar[day] = {\n                isKitaOpenNoEd: true,\n                isValidDay: false,\n                isAssigned: false,\n                parents: parents\n            };\n            continue;\n        }\n        if (!$0ad82ee3386c69da$var$isValidWeekday(year, month, day, weekdays) || $0ad82ee3386c69da$var$isHoliday(year, month, day, holidays)) {\n            calendar[day] = {\n                isKitaOpenNoEd: false,\n                isValidDay: false,\n                isAssigned: false,\n                parents: parents\n            };\n            continue;\n        }\n        const availableUsers = $0ad82ee3386c69da$var$getAvailableUsersForDay(year, month, day, _users);\n        // Sortiere verfügbare Nutzer anhand der Priorität und Service-Zahl (mit etwas Zufall)\n        const usersSortedByPrio = availableUsers.sort((a, b)=>{\n            if (a.serviceCount === b.serviceCount && a.prioOffsetFactor === 1 && b.prioOffsetFactor === 1) return Math.random() < 0.5 ? -1 : 1;\n            if (a.prio < b.prio) return -1;\n            if (a.prio > b.prio) return 1;\n            if (a.serviceCount < b.serviceCount) return -1;\n            if (a.serviceCount > b.serviceCount) return 1;\n            return Math.random() < 0.5 ? -1 : 1;\n        });\n        const requiredCount = $0ad82ee3386c69da$var$isTeamDay(year, month, day, teamdays) ? cols - 1 : cols;\n        const selected = $0ad82ee3386c69da$var$pickUsers(usersSortedByPrio, requiredCount);\n        const specificPerson = $0ad82ee3386c69da$var$isTeamDay(year, month, day, teamdays) ? options.specificPerson : undefined;\n        calendar[day] = {\n            isKitaOpenNoEd: false,\n            isValidDay: true,\n            specificPerson: specificPerson,\n            isAssigned: usersSortedByPrio.length >= requiredCount,\n            parents: selected.map((parent)=>parent.name)\n        };\n        selected.forEach((user)=>{\n            if (user.name !== (0, $kaKyP.default)(\"create.notSet\")) $0ad82ee3386c69da$var$updateUsersArray(_users, averageServiceCount, true, user);\n        });\n        if (usersSortedByPrio.length >= requiredCount) {\n            const names = selected.map((u)=>u.name);\n            const dup = names.find((n, i)=>names.indexOf(n) !== i);\n            if (dup) {\n                (0, $iVdgJ.displayError)((0, $kaKyP.default)(\"create.shouldNotHappen\"));\n                throw new Error(\"Duplicate users in data set\");\n            }\n        }\n    }\n    return calendar;\n}\n\n});\n\n\n\n//# sourceMappingURL=create.fa346956.js.map\n","import {getStorageKey} from \"../storageKey\";\nimport { renderMonthYearSelect } from \"../utils/render\"\nimport getText from \"../localization\"\nimport { displayError } from \"../utils/render\";\n\nimport {\n    formatDate,\n    formatDayOfWeek,\n    generateShiftplanPdf,\n} from \"./generateShiftplanPdf.js\";\nimport {assignUsersCalendar} from \"./assignUsersCalendar\";\n\nlet usersData = [];         // Temporäre Speicherung der Nutzerdaten\nlet formattedUsers = [];      // Formatierte Nutzerdaten\nlet selectedWeekdays = [];\nconst WEEKDAY_MAPPING = {\n    Mo: \"Monday\",\n    Di: \"Tuesday\",\n    Mi: \"Wednesday\",\n    Do: \"Thursday\",\n    Fr: \"Friday\",\n    Sa: \"Saturday\",\n    So: \"Sunday\",\n};\nlet holidays = [];\nlet kitaOpenNoEd = [];\nlet teamdays = [];\nlet calendar = null;\n\n\nexport function initialize(backurl) {\n    const toggleBtn = document.getElementById('toggle-summary');\n    const parentSummary = document.getElementById('parent-summary');\n\n    toggleBtn.addEventListener('click', () => {\n        parentSummary.classList.toggle('hidden');\n    });\n\n    const jsonUsers = localStorage.getItem(getStorageKey());\n    if (jsonUsers) {\n        usersData = JSON.parse(jsonUsers);\n    }\n    renderMonthYearSelect();\n    formatUsersData(usersData);\n    updateCalendar();\n\n    document.getElementById(\"back-button\").addEventListener(\"click\", () => {\n        window.location.href = backurl;\n    });\n\n    document.getElementById(\"month\").addEventListener(\"change\", () => updateCalendar());\n    document.getElementById(\"year\").addEventListener(\"change\", () => updateCalendar());\n\n    document.getElementById(\"onlySelected\").addEventListener(\"click\", () => {\n        renderCalendarPreview(formattedUsers.filter(user => user.name !== document.getElementById(\"nameInput\")?.value?.trim()))\n        document.getElementById(\"customModal\").classList.add(\"hidden\");\n    })\n\n    document.getElementById(\"cancel\").addEventListener(\"click\", () => {\n        document.getElementById(\"customModal\").classList.add(\"hidden\");\n    })\n\n    document.getElementById(\"show-preview-button\").addEventListener(\"click\", function () {\n        const specificPerson = document.getElementById(\"nameInput\")?.value?.trim();\n        const isSpecificPersonInUsersArray = usersData?.find(user => user === specificPerson);\n        if (isSpecificPersonInUsersArray) {\n            showCustomModal(specificPerson);\n            return\n        }\n\n        if (teamdays.length !== 0 && !specificPerson) {\n            alert(getText(\"create.specificPersonMissing\"))\n            return\n        }\n        renderCalendarPreview();\n    });\n\n    document.getElementById(\"back-creation-button\").addEventListener(\"click\", function () {\n        document.getElementById(\"plan-creation-container\").classList.remove(\"hidden\");\n        document.getElementById(\"calendar-preview-container\").classList.add(\"hidden\");\n    })\n\n    document.querySelectorAll(\".weekday-checkbox\").forEach((checkbox) => {\n        checkbox.addEventListener(\"change\", () => {\n            updateCalendar();\n        });\n    });\n}\n\nfunction formatUsersData(users) {\n    formattedUsers = users.map((user) => ({\n        name: user,\n        not_available: [],\n    }));\n}\n\nfunction renderCalendarPreview(subsetFormattedUsers) {\n    document.getElementById(\"plan-creation-container\").classList.add(\"hidden\");\n    document.getElementById(\"calendar-preview-container\").classList.remove(\"hidden\");\n\n    const usersToAssign = subsetFormattedUsers ?? formattedUsers\n    const month = parseInt(document.getElementById(\"month\").value) + 1;\n    const year = parseInt(document.getElementById(\"year\").value);\n\n    const selectedWeekdays = Array.from(\n        document.querySelectorAll(\".weekday-checkbox:checked\")\n    ).map((checkbox) => WEEKDAY_MAPPING[checkbox.value]);\n\n    const options = {\n        weekdays: selectedWeekdays,\n        holidays,\n        kitaOpenNoEd,\n        teamdays,\n        specificPerson: document.getElementById(\"nameInput\")?.value\n    };\n    const shiftValue = document.querySelector('input[name=\"shifts-per-day\"]:checked')?.value ?? 2\n    calendar = assignUsersCalendar(month, year, usersToAssign, options, Number(shiftValue));\n    renderPdfPreview(month, year);\n}\n\nfunction renderPdfPreview(month, year) {\n    const previewBody = document.getElementById(\"calendar-preview-table\");\n    const twoColHeader = document.getElementById(\"tableheadersTwoCols\");\n    const threeColHeader = document.getElementById(\"tableheadersThreeCols\");\n\n    previewBody.innerHTML = \"\";\n    twoColHeader.classList.add(\"hidden\");\n    threeColHeader.classList.remove(\"hidden\");\n    previewBody.appendChild(twoColHeader);\n    previewBody.appendChild(threeColHeader);\n\n    const calendarEntries = Object.entries(calendar).map(\n        ([day, {parents, isKitaOpenNoEd, isAssigned, isValidDay, invalidText, specificPerson}]) => ({day, parents, meta: {isAssigned, isValidDay, invalidText, isKitaOpenNoEd, specificPerson}})\n    );\n\n    const parentCount = {};\n    calendarEntries.forEach(({parents, meta}) => {\n        if (meta.specificPerson)\n            parentCount[meta.specificPerson] = (parentCount[parent] || 0) + 1\n        parents.forEach((parent) => {\n            if (meta.isValidDay && parent && parent !== getText(\"create.notSet\"))\n                parentCount[parent] = (parentCount[parent] || 0) + 1;\n        })\n    });\n\n    const summaryDiv = document.getElementById(\"parent-summary\");\n    summaryDiv.innerHTML = \"\";\n    Object.entries(parentCount)\n        .sort(([a], [b]) => a.localeCompare(b))\n        .forEach(([parent, count]) => {\n            const summaryItem = document.createElement(\"div\");\n            summaryItem.classList.add(\"flex\", \"justify-between\", \"py-1\", \"cursor-pointer\");\n            summaryItem.innerHTML = `\n                <span class=\"font-medium text-gray-800\">${parent}</span>\n                <span class=\"text-gray-600\">(${count})</span>\n            `;\n            summaryItem.addEventListener(\"click\", () => {\n                document.querySelectorAll(\"#parent-summary > div\").forEach((item) => item.classList.remove(\"bg-green-200\"));\n                summaryItem.classList.add(\"bg-green-200\");\n                const selects = document.querySelectorAll(\"#calendar-preview-table select\");\n                selects.forEach((select) => {\n                    if (select.value === parent)\n                        select.classList.add(\"bg-green-200\");\n                    else\n                        select.classList.remove(\"bg-green-200\");\n                });\n            });\n            summaryDiv.appendChild(summaryItem);\n        });\n\n    for (const entry of calendarEntries) {\n        const {day, parents, meta} = entry;\n        const flexContainer = document.createElement(\"div\");\n        flexContainer.classList.add(\"flex\", \"flex-col\", \"md:flex-row\", \"w-full\", \"py-1\", \"border\");\n\n        const rowDayDiv = document.createElement(\"div\");\n        rowDayDiv.textContent = formatDayOfWeek(day, month, year);\n        rowDayDiv.classList.add(\"w-full\", \"md:w-1/12\", \"text-left\");\n\n        const rowDateDiv = document.createElement(\"div\");\n        rowDateDiv.textContent = formatDate(day, month, year);\n        rowDateDiv.classList.add(\"w-full\", \"md:w-1/6\", \"text-left\");\n\n        flexContainer.appendChild(rowDayDiv);\n        flexContainer.appendChild(rowDateDiv);\n\n        if (meta.isKitaOpenNoEd) {\n            flexContainer.classList.add(\"bg-yellow-200\");\n            const invalidDayInput = document.createElement(\"input\");\n            invalidDayInput.type = \"text\";\n            invalidDayInput.value = calendar[day].invalidText || \"\";\n            invalidDayInput.classList.add(\"flex-1\", \"text-center\", \"bg-yellow-200\");\n            invalidDayInput.setAttribute(\"tabindex\", \"0\");\n            invalidDayInput.addEventListener(\"change\", () => {\n                calendar[day].invalidText = invalidDayInput.value.trim();\n                renderPdfPreview(month, year);\n            });\n            flexContainer.appendChild(invalidDayInput);\n        } else if (!meta.isValidDay) {\n            flexContainer.classList.add(\"bg-red-200\");\n            const invalidDayInput = document.createElement(\"input\");\n            invalidDayInput.type = \"text\";\n            invalidDayInput.value = calendar[day].invalidText || \"\";\n            invalidDayInput.classList.add(\"flex-1\", \"text-center\", \"bg-red-200\");\n            invalidDayInput.setAttribute(\"tabindex\", \"0\");\n            invalidDayInput.addEventListener(\"change\", () => {\n                calendar[day].invalidText = invalidDayInput.value.trim();\n                renderPdfPreview(month, year);\n            });\n            flexContainer.appendChild(invalidDayInput);\n        } else {\n            parents.forEach((parent, index) => {\n                const user3Select = document.createElement(\"select\");\n                user3Select.classList.add(\"flex-1\", \"text-left\", \"cursor-pointer\");\n                if (!usersData.find(user => user === parent)) {\n                    user3Select.classList.add(\"bg-yellow-200\");\n                }\n                const noSelectionUser3 = document.createElement(\"option\");\n                const textNotSet = getText(\"create.notSet\")\n                noSelectionUser3.value = textNotSet;\n                noSelectionUser3.textContent = textNotSet;\n                if (parent === textNotSet) noSelectionUser3.selected = true;\n                user3Select.appendChild(noSelectionUser3);\n                usersData.forEach((user) => {\n                    const option = document.createElement(\"option\");\n                    option.value = user;\n                    option.textContent = user;\n                    if (user === parent) option.selected = true;\n                    user3Select.appendChild(option);\n                });\n\n                user3Select.addEventListener(\"change\", () => {\n                        const isSet = user3Select.value !== textNotSet;\n                        const naDateArray = formattedUsers.find(fUser => fUser.name === user3Select.value)?.not_available || [];\n                        let continueProcess = true;\n                        if (isSet && naDateArray.includes(`${year}-${month}-${day}`)) {\n                            continueProcess = confirm(getText(\"create.personNotAvailableAlert\"));\n                        }\n                        if (continueProcess) {\n                            calendar[day].parents[index] = user3Select.value;\n                        } else {\n                            user3Select.value = calendar[day].parents[index];\n                        }\n                        renderPdfPreview(month, year);\n                    });\n\n                flexContainer.appendChild(user3Select)\n            })\n            if (meta.specificPerson) {\n                const user3Select = document.createElement(\"select\");\n                user3Select.classList.add(\"flex-1\", \"text-left\", \"cursor-pointer\");\n                const teamOption = document.createElement(\"option\");\n                teamOption.value = meta.specificPerson;\n                teamOption.textContent = meta.specificPerson;\n                teamOption.selected = true;\n                user3Select.appendChild(teamOption);\n                user3Select.disabled = true;\n                user3Select.value = meta.specificPerson\n\n                user3Select.classList.add(\"cursor-not-allowed\");\n                flexContainer.appendChild(user3Select)\n            }\n        }\n        previewBody.appendChild(flexContainer);\n    }\n}\n\ndocument.getElementById(\"preview-button\").addEventListener(\"click\", () => {\n    renderCalendarPreview();\n    console.log(\"Preview updated\");\n});\n\nfunction updateCalendar() {\n    formattedUsers.forEach((user) => (user.not_available = []));\n    holidays = [];\n    teamdays = [];\n    kitaOpenNoEd = [];\n    selectedWeekdays = Array.from(\n        document.querySelectorAll(\".weekday-checkbox:checked\")\n    ).map((checkbox) => checkbox.value);\n    populateUserTable(formattedUsers);\n    updateHolidayCalendar();\n    updateKitaOpenNoEdCalendar();\n    updateTeamTakesSlotCalendar();\n}\n\nfunction populateUserTable(users) {\n    const userTableBody = document.getElementById(\"user-table-body\");\n    userTableBody.innerHTML = \"\";\n    const month = document.getElementById(\"month\").value;\n    const year = document.getElementById(\"year\").value;\n    users.sort((a, b) => a?.name?.localeCompare(b?.name)).forEach((user) => {\n        const row = document.createElement(\"tr\");\n        row.classList.add(\"border-b\");\n        const userCell = document.createElement(\"td\");\n        userCell.classList.add(\"p-4\", \"border\", \"border-gray-300\", \"rounded-lg\");\n        const userNameElement = document.createElement(\"div\");\n        userNameElement.textContent = user.name;\n        userNameElement.classList.add(\"font-semibold\", \"text-lg\", \"mb-2\", \"text-gray-800\", \"p-2\", \"bg-gray-100\", \"rounded-md\");\n        userCell.appendChild(userNameElement);\n        const jsonInput = document.createElement(\"input\");\n        jsonInput.type = \"text\";\n        jsonInput.placeholder = getText(\"create.insertBlockedTime\");\n        jsonInput.classList.add(\"w-full\", \"p-2\", \"border\", \"border-gray-300\", \"rounded-md\", \"mt-2\", \"focus:outline-none\", \"focus:ring-2\", \"focus:ring-blue-500\", \"bg-white\");\n        const confirmButton = document.createElement(\"button\");\n        confirmButton.textContent = getText(\"create.confirm\");\n        confirmButton.classList.add(\"mt-2\", \"px-4\", \"py-2\", \"bg-blue-500\", \"text-white\", \"rounded-md\", \"hover:bg-blue-600\", \"focus:outline-none\", \"focus:ring-2\", \"focus:ring-blue-500\");\n        confirmButton.addEventListener(\"click\", function () {\n            try {\n                const jsonData = JSON.parse(jsonInput.value);\n                if (Array.isArray(jsonData)) {\n                    const dateRegex = /^\\d{4}-\\d{1,2}-\\d{1,2}$/;\n                    const isValid = jsonData.every(item => typeof item === 'string' && dateRegex.test(item));\n                    if (isValid) {\n                        user.not_available = jsonData;\n                        populateUserTable(users);\n                    } else {\n                        alert(getText(\"create.dateStringInvalidDates\"));\n                    }\n                } else {\n                    alert(getText(\"create.dateStringInvalidList\"));\n                }\n            } catch (error) {\n                console.log(error)\n                alert(getText(\"create.generalError\"));\n            }\n        });\n        userCell.appendChild(jsonInput);\n        userCell.appendChild(confirmButton);\n        row.appendChild(userCell);\n\n        const calendarCell = document.createElement(\"td\");\n        calendarCell.classList.add(\"p-2\");\n        const daysContainer = document.createElement(\"div\");\n        daysContainer.classList.add(\"calendar\");\n        const daysOfWeek = [getText(\"daysShort.mo\"), getText(\"daysShort.di\"), getText(\"daysShort.mi\"), getText(\"daysShort.do\"), getText(\"daysShort.fr\"), getText(\"daysShort.sa\"), getText(\"daysShort.so\")];\n        daysOfWeek.forEach((day) => {\n            const dayHeader = document.createElement(\"div\");\n            dayHeader.classList.add(\"calendar-header\");\n            dayHeader.textContent = day;\n            daysContainer.appendChild(dayHeader);\n        });\n\n        const firstDayOfMonth = new Date(year, parseInt(month), 1).getDay();\n        const firstDayAdjusted = (firstDayOfMonth + 6) % 7;\n        for (let i = 0; i < firstDayAdjusted; i++) {\n            const emptyCell = document.createElement(\"div\");\n            emptyCell.classList.add(\"calendar-day\");\n            daysContainer.appendChild(emptyCell);\n        }\n\n        const daysInMonth = new Date(year, parseInt(month) + 1, 0).getDate();\n        for (let day = 1; day <= daysInMonth; day++) {\n            const dayButton = document.createElement(\"div\");\n            dayButton.classList.add(\"calendar-day\");\n            dayButton.textContent = day.toString();\n            const dayOfWeek = new Date(year, parseInt(month), day).getDay();\n            const dayName = daysOfWeek[dayOfWeek - 1];\n            if (!selectedWeekdays.includes(dayName)) {\n                dayButton.classList.add(\"excluded\");\n                dayButton.style.cursor = \"default\";\n            } else {\n                const isNotAvailable = user.not_available.includes(`${year}-${parseInt(month) + 1}-${day}`);\n                if (isNotAvailable) {\n                    dayButton.classList.add(\"not-available\");\n                }\n                dayButton.addEventListener(\"click\", () => {\n                    const dateKey = `${year}-${parseInt(month) + 1}-${day}`;\n                    const isCurrentlyNotAvailable = user.not_available.includes(dateKey);\n                    if (isCurrentlyNotAvailable) {\n                        user.not_available = user.not_available.filter((date) => date !== dateKey);\n                        dayButton.classList.remove(\"not-available\");\n                    } else {\n                        user.not_available.push(dateKey);\n                        dayButton.classList.add(\"not-available\");\n                    }\n                });\n            }\n            daysContainer.appendChild(dayButton);\n        }\n\n        calendarCell.appendChild(daysContainer);\n        row.appendChild(calendarCell);\n        userTableBody.appendChild(row);\n    });\n}\n\nfunction updateHolidayCalendar() {\n    updateGenericCalender(\"holidays-calendar\", holidays);\n}\n\nfunction updateKitaOpenNoEdCalendar() {\n    updateGenericCalender(\"kitaOpenNoEd-calendar\", kitaOpenNoEd);\n}\n\nfunction updateTeamTakesSlotCalendar() {\n    updateGenericCalender(\"team-calendar\", teamdays);\n}\n\nfunction updateGenericCalender(id, subjectArray) {\n    const month = document.getElementById(\"month\").value;\n    const year = document.getElementById(\"year\").value;\n    const subjectCalendar = document.getElementById(id);\n    subjectCalendar.innerHTML = \"\";\n    const daysOfWeek = [getText(\"daysShort.mo\"), getText(\"daysShort.di\"), getText(\"daysShort.mi\"), getText(\"daysShort.do\"), getText(\"daysShort.fr\"), getText(\"daysShort.sa\"), getText(\"daysShort.so\")];\n    daysOfWeek.forEach((day) => {\n        const dayHeader = document.createElement(\"div\");\n        dayHeader.classList.add(\"calendar-header\");\n        dayHeader.textContent = day;\n        subjectCalendar.appendChild(dayHeader);\n    });\n    const firstDayOfMonth = new Date(year, parseInt(month), 1).getDay();\n    const firstDayAdjusted = (firstDayOfMonth + 6) % 7;\n    for (let i = 0; i < firstDayAdjusted; i++) {\n        const emptyCell = document.createElement(\"div\");\n        emptyCell.classList.add(\"calendar-day\");\n        subjectCalendar.appendChild(emptyCell);\n    }\n    const daysInMonth = new Date(year, parseInt(month) + 1, 0).getDate();\n    for (let day = 1; day <= daysInMonth; day++) {\n        const dayButton = document.createElement(\"div\");\n        dayButton.classList.add(\"calendar-day\");\n        dayButton.textContent = day.toString();\n        const dayOfWeek = new Date(year, parseInt(month), day).getDay();\n        const dayName = daysOfWeek[dayOfWeek - 1];\n        if (!selectedWeekdays.includes(dayName)) {\n            dayButton.classList.add(\"excluded\");\n            dayButton.style.cursor = \"default\";\n        } else {\n            const isSubject = subjectArray.includes(`${year}-${parseInt(month) + 1}-${day}`);\n            if (isSubject) {\n                dayButton.classList.add(\"not-available\");\n            }\n            dayButton.addEventListener(\"click\", () => {\n                const dateKey = `${year}-${parseInt(month) + 1}-${day}`;\n                const isCurrentlySubject = subjectArray.includes(dateKey);\n                if (isCurrentlySubject) {\n                    const index = subjectArray.indexOf(dateKey);\n                    if (index > -1) {\n                        subjectArray.splice(index, 1);\n                    }\n                    dayButton.classList.remove(\"not-available\");\n                } else {\n                    subjectArray.push(dateKey);\n                    dayButton.classList.add(\"not-available\");\n                }\n            });\n        }\n        subjectCalendar.appendChild(dayButton);\n    }\n}\n\ndocument.getElementById(\"generate-pdf-button\").addEventListener(\"click\", async () => {\n    const month = parseInt(document.getElementById(\"month\").value) + 1;\n    const year = parseInt(document.getElementById(\"year\").value);\n    try {\n        if (!calendar || Object.entries(calendar).length === 0) {\n            displayError(getText(\"create.forceUpdatePreview\"));\n            return;\n        }\n        let fileBlob\n\n        const shiftValue = document.querySelector('input[name=\"shifts-per-day\"]:checked')?.value;\n        let isKita = false\n        if (shiftValue === \"3\") {\n            fileBlob = generateShiftplanPdf(calendar, month, year, usersData, isKita, 3);\n        } else if (shiftValue === \"2\") {\n            fileBlob = generateShiftplanPdf(calendar, month, year, usersData, isKita, 2);\n        } else {\n            isKita = true\n            fileBlob = generateShiftplanPdf(calendar, month, year, usersData, isKita, 2);\n        }\n        const downloadLink = document.createElement(\"a\");\n        downloadLink.href = URL.createObjectURL(fileBlob);\n        downloadLink.download = isKita ? `${getText(\"create.kitaplanpdf\")}_${year}_${month}.pdf` : `${getText(\"create.shiftplanpdf\")}_${year}_${month}.pdf`;\n        document.body.appendChild(downloadLink);\n        downloadLink.click();\n        document.body.removeChild(downloadLink);\n        console.log(\"PDF generated successfully\");\n    } catch (error) {\n        console.error(error.message);\n    }\n});\n\nfunction showCustomModal(personName) {\n    document.getElementById(\"modalText\").innerHTML = `\n    ${personName} ${getText(\"create.specialshiftsInfo\")}`;\n    document.getElementById(\"customModal\").classList.remove(\"hidden\");\n}\n","import getText from \"../localization\"\n// Get the error message display element\n\n// Helper function to format the date (z.B. \"01.10\")\nexport function formatDate(day, month, year) {\n    const date = new Date(year, month - 1, day);\n    return window.dateFns.format(date, 'dd.MM', {locale: window.dateFns.locale.de});\n}\n\n// Helper function, um den Wochentag (z.B. \"Mo\") zu formatieren\nexport function formatDayOfWeek(day, month, year) {\n    const date = new Date(year, month - 1, day);\n    const formattedDay = window.dateFns.format(date, 'EE', {locale: window.dateFns.locale.de});\n    return formattedDay.endsWith(\".\") ? formattedDay.slice(0, -1) : formattedDay;\n}\n\nfunction getHeaders(isKita, cols) {\n    if (isKita || cols === 2) {\n        const schicht1 = isKita ? `${getText(\"create.family\")} 1` : localStorage.getItem('twocol-label-1') || `${getText(\"create.shift\")} 1`;\n        const schicht2 = isKita ? `${getText(\"create.family\")} 2` : localStorage.getItem('twocol-label-2') || `${getText(\"create.shift\")} 2`;\n        return [[getText(\"create.day\"), getText(\"create.date\"), schicht1, schicht2]]\n    }\n    // Überschrift der Tabelle (Header) – hier bleiben wir bei 5 Zellen, da autoTable Body-Zeilen über colSpan korrekt zusammenführt.\n    const schicht1 = localStorage.getItem('threecol-label-1') || `${getText(\"create.shift\")} 1`;\n    const schicht2 = localStorage.getItem('threecol-label-2') || `${getText(\"create.shift\")} 2`;\n    const schicht3 = localStorage.getItem('threecol-label-3') || `${getText(\"create.shift\")} 3`;\n\n    return [[getText(\"create.day\"), getText(\"create.date\"), schicht1, schicht2, schicht3]];\n}\n\n/**\n * Erzeugt das PDF des Elterndienstplans. Dabei wird der Kalender (mit 3 Spalten) in eine Tabelle konvertiert.\n */\nexport function generateShiftplanPdf(calendar, month, year, usersData = [], isKita, cols) {\n    const {jsPDF} = window.jspdf;\n    const doc = new jsPDF();\n\n    // Titel und Untertitel zentrieren\n    const title = isKita ? getText(\"create.kitashiftplan\") : getText(\"create.shiftplan\")\n\n    doc.setFontSize(16);\n    doc.text(title, doc.internal.pageSize.getWidth() / 2, 15, {align: 'center'});\n    doc.setFontSize(12);\n    doc.text(`${window.dateFns.format(new Date(year, month - 1), 'MMMM yyyy', {locale: window.dateFns.locale.de})}`, doc.internal.pageSize.getWidth() / 2, 22, {align: 'center'});\n\n    const legendStartY = 28;\n    const pageWidth = doc.internal.pageSize.getWidth();\n    const legendLeftMargin = (pageWidth - 150) / 2;\n    const boxSize = 6;\n\n    // Legende: Gelber Kasten\n    doc.setFillColor(255, 230, 153);\n    doc.rect(legendLeftMargin, legendStartY, boxSize, boxSize, 'F');\n    doc.setTextColor(0, 0, 0);\n    doc.setFontSize(10);\n    const noShiftNecessaryInfo = isKita ? getText(\"create.kitashiftplanOpenInfo\") : getText(\"create.shiftplanOpenInfo\")\n    doc.text(noShiftNecessaryInfo, legendLeftMargin + boxSize + 5, legendStartY + boxSize - 1);\n\n    // Legende: Roter Kasten\n    const redBoxX = legendLeftMargin + 90;\n    doc.setFillColor(255, 204, 204);\n    doc.rect(redBoxX, legendStartY, boxSize, boxSize, 'F');\n    doc.text(getText(\"create.closedInfo\"), redBoxX + boxSize + 5, legendStartY + boxSize - 1);\n\n    let startY = legendStartY + 10;\n    let actionTaken = false;\n    const rows = [];\n\n    for (const day in calendar) {\n        let {\n            parents,\n            isValidDay,\n            isKitaOpenNoEd,\n            isAssigned,\n            invalidText,\n            specificPerson\n\n        } = calendar[day];\n\n        if (!actionTaken) {\n            const areAllUsersKnown = parents.reduce((acc, currParent) => {\n                // if one user was not found, the boolean should be persisted\n                if (acc === false)\n                    return false;\n                return !!usersData.find((user) => user === currParent);\n\n            }, true)\n\n            if (isValidDay && !areAllUsersKnown) {\n\n                const confirmedChoice = confirm(`${getText(\"create.personNotFoundOne\")} ${parents.join(\", \")}. ${getText(\"create.personNotFoundTwo\")}`);\n                if (!confirmedChoice) {\n                    return\n                }\n                actionTaken = true;\n            }\n        }\n        const formattedDate = formatDate(day, month, year);\n        const dayOfWeek = formatDayOfWeek(day, month, year);\n        // Bei gültigen Tagen wird der Inhalt aus der ersten Spalte übernommen.\n        // Für ungültige Tage (z.B. Feiertage) bzw. \"KitaOpenNoEd\" nutzen wir später einen fixen Text.\n        parents.forEach((value, index) => {\n            if (value === getText(\"create.notSet\")) {\n                parents[index] = \"\";\n            }\n        });\n\n        const parentCols = specificPerson ? [...parents, specificPerson] : parents\n        // Speichere die Zeile inklusive Meta-Daten\n        if (!isValidDay) {\n            console.log(parents, dayOfWeek, formattedDate, isKitaOpenNoEd, isAssigned, isValidDay, invalidText, specificPerson)\n        }\n        rows.push({data: [dayOfWeek, formattedDate, ...parentCols], meta: {isKitaOpenNoEd, isAssigned, isValidDay, invalidText, specificPerson}});\n    }\n\n    // Neuer Body‑Array, der für spezielle Tage (nicht valide oder KitaOpenNoEd) die Schicht-Spalten zusammenfasst:\n    const tableBody = rows.map(row => {\n        if (!row.meta.isValidDay || row.meta.isKitaOpenNoEd) {\n            let specialText = row.meta.invalidText ?? \"\";\n            let fillColor = row.meta.isKitaOpenNoEd ? [255, 230, 153] : [255, 204, 204];\n            return [\n                row.data[0],\n                row.data[1],\n                {\n                    content: specialText,\n                    colSpan: cols,\n                    styles: {halign: 'center', fillColor: fillColor, textColor: [50, 50, 50]}\n                }\n            ];\n        } else {\n            // Normale Zeile: 5 Spalten, ohne Veränderung\n            return row.data;\n        }\n    });\n\n    const headers = getHeaders(isKita, cols)\n\n    // Gesamte Tabellenspaltenbreiten (aus Column-Styles)\n    // Spalte 0: 10, Spalte 1: 20, Spalte 2: 60, Spalte 3: 50, Spalte 4: 50 => Summe = 190\n    const wantedTableWidth = cols === 2 ? 150 : 190;\n    const margin = (pageWidth - wantedTableWidth) / 2;\n/*\ncolumnStyles 2 cols\ncolumnStyles: {\n            0: {cellWidth: 20},\n            1: {cellWidth: 30},\n            2: {cellWidth: 50},\n\n\n            3: {cellWidth: 50}\n        },\n */\n    // Aufruf von autoTable – alternativ: Für normale Zeilen nutzen wir das Alternating Row Style\n    doc.autoTable({\n        head: headers,\n        body: tableBody,\n        startY: startY,\n        theme: 'grid',\n        headStyles: {fillColor: [100, 100, 255]},\n        alternateRowStyles: {fillColor: [245, 245, 245]},\n        bodyStyles: {halign: 'center'},\n        columnStyles: {\n            0: {cellWidth: 10},\n            1: {cellWidth: 20},\n            2: {cellWidth: 60},\n            3: {cellWidth: 50},\n            4: {cellWidth: 50}\n        },\n        margin: {left: margin, right: margin}\n    });\n\n    return doc.output('blob');\n}","import getText from \"../localization\";\nimport { displayError } from \"../utils/render\";\n\n// Function to update the selected user's data (service count and prio)\nfunction updateUsersArray(_users, averageServiceCount, hasEnoughUsers, selectedUser) {\n    if (hasEnoughUsers) {\n        _users.forEach((user) => {\n            if (user.name === selectedUser.name) {\n                // Update service count and adjust priority\n                const newServiceCount = user.serviceCount + 1;\n                let newPrio;\n                if (newServiceCount >= averageServiceCount) {\n                    newPrio = 1000;\n                } else if (user.prioOffsetFactor === 0) {\n                    newPrio = -1000;\n                } else {\n                    newPrio = 10 * user.prioOffsetFactor;\n                }\n                user.prio = newPrio;\n                user.serviceCount = newServiceCount;\n            } else {\n                user.prio = user.prio === 1000 ? 1000 : user.prio === -1000 ? -1000 : user.prio - 10;\n            }\n        });\n    }\n}\n\n// Helper functions zur Prüfung der Tage\nfunction isKitaOpenNoEd(year, month, day, kitaOpenNoEd) {\n    const formattedDate = `${year}-${month}-${day}`;\n    return kitaOpenNoEd.includes(formattedDate);\n}\n\nfunction isHoliday(year, month, day, holidays) {\n    const formattedDate = `${year}-${month}-${day}`;\n    return holidays.includes(formattedDate);\n}\n\nfunction isTeamDay(year, month, day, teamdays) {\n    const formattedDate = `${year}-${month}-${day}`;\n    return teamdays.includes(formattedDate);\n}\n\nfunction isValidWeekday(year, month, day, weekdays) {\n    const date = new Date(year, month - 1, day);\n    const weekday = date.toLocaleDateString('en-US', {weekday: 'long'});\n    return weekdays.includes(weekday);\n}\n\n// Berechne die Anzahl der Tage, an denen ein Dienst stattfindet\nfunction calcUniqueServiceDays(year, month, daysInMonth, kitaOpenNoEd, holidays, weekdays) {\n    let total = 0;\n    for (let day = 1; day <= daysInMonth; day++) {\n        // Skip days where Kita is open without education,\n        // invalid weekdays, or holidays in one combined check\n        if (isKitaOpenNoEd(year, month, day, kitaOpenNoEd) || !isValidWeekday(year, month, day, weekdays) || isHoliday(year, month, day, holidays)) {\n            continue;\n        }\n        total++;\n    }\n    return total;\n}\n\nfunction isUserAvailable(user, dateString) {\n    return !user.not_available.includes(dateString);\n}\n\nfunction getAvailableUsersForDay(year, month, day, localUsers) {\n    const dateString = `${year}-${month}-${day}`;\n    return localUsers.filter(user => isUserAvailable(user, dateString));\n}\n\nfunction pickUsers(usersSortedByPrio, requiredCount) {\n    const picks = usersSortedByPrio.slice(0, requiredCount);\n    while (picks.length < requiredCount) {\n        picks.push({name: getText(\"create.notSet\")});\n    }\n    return picks;\n}\n\nexport function assignUsersCalendar(month, year, localUsers, options = {}, cols) {\n    const calendar = {}; // Kalenderspeicher\n    const {\n        weekdays = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'],\n        holidays = [],\n        kitaOpenNoEd = [],\n        teamdays = []\n    } = options;\n\n    const daysInMonth = new Date(year, month, 0).getDate();\n    const uniqueServiceDays = calcUniqueServiceDays(year, month, daysInMonth, kitaOpenNoEd, holidays, weekdays);\n    // Anpassen: Berechne den Durchschnitt anhand von 3 Schicht-Spalten (statt 2)\n    // #Duplicate von oben bis hier.\n    // # 3 mit arg ersetzen\n    const averageServiceCount = Math.floor(uniqueServiceDays * cols / localUsers.length);\n\n    // Kopiere und erweitere die Nutzer-Daten\n    const _users = [...localUsers].map((user) => {\n        const cleanedNotAvailableArray = user[\"not_available\"].filter((date) => {\n            const extractedDay = date.split(\"-\")[2];\n            if (extractedDay === undefined) return false\n            if (isHoliday(year, month, extractedDay, holidays)) return false\n            if (isKitaOpenNoEd(year, month, extractedDay, kitaOpenNoEd)) return false\n            return isValidWeekday(year, month, extractedDay, weekdays);\n        })\n\n        const availableTotal = uniqueServiceDays - cleanedNotAvailableArray.length;\n        const prioOffsetFactor = availableTotal <= uniqueServiceDays / 4 ? 0 :\n            availableTotal <= uniqueServiceDays / 2 ? 2 : 1;\n        return {\n            ...user,\n            \"not_available\": cleanedNotAvailableArray,\n            serviceCount: 0,\n            prioOffsetFactor,\n            // Der niedrigere Wert = höhere Chance ausgewählt zu werden\n            prio: availableTotal <= uniqueServiceDays / 4 ? -1000 : -10 * prioOffsetFactor\n        };\n    });\n\n    for (let day = 1; day <= daysInMonth; day++) {\n        // Sonderfälle: Tage, an denen kein Dienst stattfindet\n        const parents = Array(cols).fill(\"\")\n        if (isKitaOpenNoEd(year, month, day, kitaOpenNoEd)) {\n            calendar[day] = {isKitaOpenNoEd: true, isValidDay: false, isAssigned: false, parents};\n            continue;\n        }\n        if (!isValidWeekday(year, month, day, weekdays) || isHoliday(year, month, day, holidays)) {\n            calendar[day] = {isKitaOpenNoEd: false, isValidDay: false, isAssigned: false, parents};\n            continue;\n        }\n\n        const availableUsers = getAvailableUsersForDay(year, month, day, _users);\n        // Sortiere verfügbare Nutzer anhand der Priorität und Service-Zahl (mit etwas Zufall)\n        const usersSortedByPrio = availableUsers.sort((a, b) => {\n            if (a.serviceCount === b.serviceCount && a.prioOffsetFactor === 1 && b.prioOffsetFactor === 1) {\n                return Math.random() < 0.5 ? -1 : 1;\n            }\n            if (a.prio < b.prio) return -1;\n            if (a.prio > b.prio) return 1;\n            if (a.serviceCount < b.serviceCount) return -1;\n            if (a.serviceCount > b.serviceCount) return 1;\n            return Math.random() < 0.5 ? -1 : 1;\n        });\n\n        const requiredCount = isTeamDay(year, month, day, teamdays) ? cols - 1 : cols;\n        const selected = pickUsers(usersSortedByPrio, requiredCount);\n        const specificPerson = isTeamDay(year, month, day, teamdays) ? options.specificPerson : undefined;\n        calendar[day] = {\n            isKitaOpenNoEd: false,\n            isValidDay: true,\n            specificPerson,\n            isAssigned: usersSortedByPrio.length >= requiredCount,\n            parents: selected.map((parent) => parent.name)\n        }\n\n        selected.forEach(user => {\n            if (user.name !== getText(\"create.notSet\")) {\n                updateUsersArray(_users, averageServiceCount, true, user);\n            }\n        });\n\n        if (usersSortedByPrio.length >= requiredCount) {\n            const names = selected.map(u => u.name);\n            const dup = names.find((n, i) => names.indexOf(n) !== i);\n            if (dup) {\n                displayError(getText(\"create.shouldNotHappen\"));\n                throw new Error(\"Duplicate users in data set\");\n            }\n        }\n    }\n    return calendar;\n}"],"names":["$parcel$export","e","n","v","s","Object","defineProperty","get","set","enumerable","configurable","$parcel$global","globalThis","$parcel$modules","$parcel$inits","parcelRequire","id","exports","init","module","call","err","Error","code","register","parcelRegister","$e80396a3d35d2658$export$2a47f398eeff8b01","$iOioM","$iVdgJ","$kaKyP","$dVfXR","$VIWgv","$e80396a3d35d2658$var$usersData","$e80396a3d35d2658$var$formattedUsers","$e80396a3d35d2658$var$selectedWeekdays","$e80396a3d35d2658$var$WEEKDAY_MAPPING","Mo","Di","Mi","Do","Fr","Sa","So","$e80396a3d35d2658$var$holidays","$e80396a3d35d2658$var$kitaOpenNoEd","$e80396a3d35d2658$var$teamdays","$e80396a3d35d2658$var$calendar","backurl","toggleBtn","document","getElementById","parentSummary","addEventListener","classList","toggle","jsonUsers","localStorage","getItem","getStorageKey","JSON","parse","renderMonthYearSelect","users","map","user","name","not_available","$e80396a3d35d2658$var$updateCalendar","window","location","href","$e80396a3d35d2658$var$renderCalendarPreview","filter","value","trim","add","personName","specificPerson","find","innerHTML","default","remove","length","alert","querySelectorAll","forEach","checkbox","subsetFormattedUsers","usersToAssign","month","parseInt","year","options","weekdays","Array","from","holidays","kitaOpenNoEd","teamdays","shiftValue","querySelector","assignUsersCalendar","Number","$e80396a3d35d2658$var$renderPdfPreview","previewBody","twoColHeader","threeColHeader","appendChild","calendarEntries","entries","day","parents","isKitaOpenNoEd","isAssigned","isValidDay","invalidText","meta","parentCount","parent","parent1","summaryDiv","entry","sort","a","b","localeCompare","count","summaryItem","createElement","item","selects","select","flexContainer","rowDayDiv","textContent","formatDayOfWeek","rowDateDiv","formatDate","invalidDayInput","type","setAttribute","index","user3Select","noSelectionUser3","textNotSet","selected","option","isSet","naDateArray","fUser","continueProcess","includes","confirm","teamOption","disabled","$e80396a3d35d2658$var$populateUserTable","userTableBody","row","userCell","userNameElement","jsonInput","placeholder","confirmButton","jsonData","isArray","dateRegex","every","test","error","console","log","calendarCell","daysContainer","daysOfWeek","dayHeader","firstDayAdjusted","firstDayOfMonth","Date","getDay","i","emptyCell","daysInMonth","getDate","dayButton","toString","dayName","dayOfWeek","isNotAvailable","dateKey","date","push","style","cursor","$e80396a3d35d2658$var$updateGenericCalender","subjectArray","subjectCalendar","isSubject","indexOf","splice","fileBlob","displayError","isKita","generateShiftplanPdf","downloadLink","URL","createObjectURL","download","body","click","removeChild","message","$a22cfb7663804a46$export$3ae94a2503e890a1","$a22cfb7663804a46$export$f484d8a20c1ae790","$a22cfb7663804a46$export$22d5759ea413b875","dateFns","format","locale","de","formattedDay","endsWith","slice","calendar","usersData","cols","jsPDF","jspdf","doc","title","setFontSize","text","internal","pageSize","getWidth","align","pageWidth","legendLeftMargin","setFillColor","rect","setTextColor","noShiftNecessaryInfo","legendStartY","redBoxX","actionTaken","rows","areAllUsersKnown","reduce","acc","currParent","join","formattedDate","parentCols","data","tableBody","specialText","fillColor","content","colSpan","styles","halign","textColor","headers","$a22cfb7663804a46$var$getHeaders","schicht1","schicht2","schicht3","margin","autoTable","head","startY","theme","headStyles","alternateRowStyles","bodyStyles","columnStyles","cellWidth","left","right","output","$0ad82ee3386c69da$export$3b73c77273a86041","$0ad82ee3386c69da$var$isKitaOpenNoEd","$0ad82ee3386c69da$var$isHoliday","$0ad82ee3386c69da$var$isTeamDay","$0ad82ee3386c69da$var$isValidWeekday","weekday","toLocaleDateString","localUsers","uniqueServiceDays","$0ad82ee3386c69da$var$calcUniqueServiceDays","total","averageServiceCount","Math","floor","_users","cleanedNotAvailableArray","extractedDay","split","undefined","availableTotal","prioOffsetFactor","serviceCount","prio","fill","usersSortedByPrio","availableUsers","$0ad82ee3386c69da$var$getAvailableUsersForDay","dateString","random","requiredCount","$0ad82ee3386c69da$var$pickUsers","picks","$0ad82ee3386c69da$var$updateUsersArray","hasEnoughUsers","selectedUser","newPrio","newServiceCount","names","u"],"version":3,"file":"create.fa346956.js.map"}